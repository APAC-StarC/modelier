{% extends 'pointclouds/potree_base.html' %}

{% block content %}
    {{ block.super }}
    <style>
        .action-btn {
            cursor: pointer;
            padding-left: 5px;
            padding-right: 5px;
        }

        .action-btn svg {
            width: 15px;
            height: 20px;
            fill: #384348;
            display: inline-block;
            vertical-align: middle;
        }

        #hotspot_details .log {
            color: red;
            font-size: 10px;
        }
    </style>
    <div id="hotspot_details" style="position: absolute; top:10px; right:10px; z-index:2;">
        <button id="go-fullscreen-btn" title="Toggle fullscreen" class="action-btn">
            <svg viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink">

                <path d="M4.20710678,17.2071068 L7,20 L0,20 L0,13 L2.79289322,15.7928932 L7.12132034,11.4644661 L8.53553391,12.8786797 L4.20710678,17.2071068 Z M15.7928932,2.79289322 L13,0 L20,0 L20,7 L17.2071068,4.20710678 L12.8786797,8.53553391 L11.4644661,7.12132034 L15.7928932,2.79289322 Z M15.7928932,17.2071068 L13,20 L20,20 L20,13 L17.2071068,15.7928932 L12.8786797,11.4644661 L11.4644661,12.8786797 L15.7928932,17.2071068 Z M4.20710678,2.79289322 L7,0 L0,0 L0,7 L2.79289322,4.20710678 L7.12132034,8.53553391 L8.53553391,7.12132034 L4.20710678,2.79289322 Z"
                      id="Combined-Shape"></path>

            </svg>
        </button>
        <button id="copy-position-btn" title="Copy camera position to clipboard" class="action-btn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                <path d="M11 12h6v-1l-3-1V2l3-1V0H3v1l3 1v8l-3 1v1h6v7l1 1 1-1v-7z"/>
            </svg>
        </button>
        <button id="copy-target-btn" title="Copy camera target to clipboard" class="action-btn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                <path d="M17.94 11H13V9h4.94A8 8 0 0 0 11 2.06V7H9V2.06A8 8 0 0 0 2.06 9H7v2H2.06A8 8 0 0 0 9 17.94V13h2v4.94A8 8 0 0 0 17.94 11zM10 20a10 10 0 1 1 0-20 10 10 0 0 1 0 20z"/>
            </svg>
        </button>
        <button id="fit-toscreen-btn" title="Fit to screen" class="action-btn">
            <svg viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink">

                <path d="M0,0 L6,0 L6,6 L0,6 L0,0 Z M2,2 L4,2 L4,4 L2,4 L2,2 Z M14,0 L20,0 L20,6 L14,6 L14,0 Z M16,2 L18,2 L18,4 L16,4 L16,2 Z M14,14 L20,14 L20,20 L14,20 L14,14 Z M16,16 L18,16 L18,18 L16,18 L16,16 Z M0,14 L6,14 L6,20 L0,20 L0,14 Z M2,16 L4,16 L4,18 L2,18 L2,16 Z M6,2 L14,2 L14,4 L6,4 L6,2 Z M6,16 L14,16 L14,18 L6,18 L6,16 Z M16,6 L18,6 L18,14 L16,14 L16,6 Z M2,6 L4,6 L4,14 L2,14 L2,6 Z M7,7 L13,7 L13,9 L7,9 L7,7 Z M9,9 L11,9 L11,13 L9,13 L9,9 Z"
                      id="Combined-Shape"></path>

            </svg>
        </button>
        <div class="log"></div>
    </div>
{% endblock %}

{% block js %}
    {{ block.super }}

    <script>
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        $("#fit-toscreen-btn").click(() => {
            window.viewer.fitToScreen();
        });
        $("#go-fullscreen-btn").click(() => {
            toggleFullScreen();
        });
        $("#copy-position-btn").click(() => {
            let cameraPositionStr = window.viewer.scene.view.position.toArray().toString();
            copyTextToClipboard(cameraPositionStr);
            $("#hotspot_details .log").html("Copied position " + cameraPositionStr);
            $("#hotspot_details .log").hide(1000, function () {
                $("#hotspot_details .log").html("");
                $("#hotspot_details .log").show();
            });
        });
        $("#copy-target-btn").click(() => {
            let targetStr = window.viewer.scene.view.getPivot().toArray().toString();
            copyTextToClipboard(targetStr);
            $("#hotspot_details .log").html("Copied target " + targetStr);
            $("#hotspot_details .log").hide(1000, function () {
                $("#hotspot_details .log").html("");
                $("#hotspot_details .log").show();
            });
        });
    </script>
    {% block comment %}
        <script>
            (function () {
                document.onclick = handleMouseClick;

                function handleMouseClick(event) {
                    var eventDoc, doc, body;
                    if (event.target.id == 'hotspot_details' || event.target.id == 'img-slider') {
                        return false;
                    }

                    event = event || window.event; // IE-ism

                    // If pageX/Y aren't available and clientX/Y are,
                    // calculate pageX/Y - logic taken from jQuery.
                    // (This is to support old IE)
                    if (event.pageX == null && event.clientX != null) {
                        eventDoc = (event.target && event.target.ownerDocument) || document;
                        doc = eventDoc.documentElement;
                        body = eventDoc.body;

                        event.pageX = event.clientX +
                            (doc && doc.scrollLeft || body && body.scrollLeft || 0) -
                            (doc && doc.clientLeft || body && body.clientLeft || 0);
                        event.pageY = event.clientY +
                            (doc && doc.scrollTop || body && body.scrollTop || 0) -
                            (doc && doc.clientTop || body && body.clientTop || 0);
                    }

                    // Use event.pageX / event.pageY here
                    //console.log(event.pageX, event.pageY);
                }
            })();
        </script>
    {% endblock %}
{% endblock %}
